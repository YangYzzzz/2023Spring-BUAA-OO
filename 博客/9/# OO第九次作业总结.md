# OO第九次作业总结

## 一.前言

第三单元主要为我们介绍了JML规格化编程，通俗来说便是给定类和方法的格式化要求，需要完成的任务为实现简单社交关系的模拟和查询，学习目标为入门级JML规格理解与代码实现。

一直在思考第三单元的博客该怎么写才好。借用我们老师的一句至理名言，“JML这种东西，我敢保证这是这辈子你第一次遇到，也会是最后一次遇到，在以后工作中是不会有人写规格的”。然而，初步的规格思想还是应该具备的，毕竟凡事都要有规矩，没有规矩乱编代码，那可是万万不能的。

具体JML格式请参考**JML_LEVEL0手册**，里面介绍了最基本的JML规格，比如前置条件，后置条件，副作用限定，再比如正常规格与异常规格等，写了那么多年代码的大家相信一定会很容易理解。

值得注意的有:
1. 代码并非要完全按照规格来写，只要满足规格所限定的要求即可，例如规格中使用数组，我们当然也可以使用容器实现。
2. 在真实的项目中存在很多变数，一定要结合JML(以后没有JML就要靠自己了)考虑可能处理到的任何情况，不合法时应抛出异常等，而不是令系统崩溃。
3. 实在想不出啥了，自行阅读手册吧

## 二.作业要求

一个非常简单的社交关系图模型，提供了几种输入:
|指令|简写|意义|
|--|--|--|
|add_person|ap|添加人物|
|add_relation|ar|添加两人关系|
|query_value|qv|查询两人好感度|
|query_circle|qci|查询两人间是否存在通路(社交链)|
|query_block_sum|qbs|查询关系图中有多少个连通子图|
|query_triple_sum|qts|查询关系图中有多少互相认识的三人组|
|query_triple_sum_ok_test|qtsok|为qts提供OK测验|

其中每个函数的规格都已给出，qbs的实现算法，或者说这个指令的用途令我思考了一会，其余照猫画虎按需实现即可。

qci中使用的图算法是**bfs**，首先需要根据personId构建一个0到num-1的一一映射，再去构建邻接矩阵即可。其他方法还可以有dfs，并查集等，目测下次作业要变成有权图算法力。

## 三.评测机搭建与测试

教程上说建议使用JUnit进行测试，笔者一开始以为JUnit能识别你每个方法的需求并量身定制输入进行自动化测试，结果证明是自己想太多了。JUnit仅仅是为每个方法设置了测试模板，让用户可以不经过庞大的体系而单独针对一个方法进行测试，输入等还是需要自己设置(好麻烦，很可能还是我的理解有误)，qtsok的实现就类似JUnit。

针对本次作业，笔者并未过多使用JUnit进行测试，而是搭建了评测机测试除qtsok外的内容。本次评测机搭建的难点在于**不变性与随机性**，即既要生成合适的数据，又要生成会抛出异常的数据，既不能完全按照规律生成，因为这样会考虑不到异常输入的情况，也不能完全不按照规律生成，因为这样会导致都是异常，难以检验正常情况。笔者采用了半随机的思路对数据进行生成，在输入指令数目较大时有较为完备的测验效果，效果很好。然而qtsok难以自动生成数据，原因与上同理，难以找到合适的随机生成方法，只能寄希望于自己的函数没有写错辣!

## 四.总结

第一次作业不算太难，以学习为主，与前两个单元相比更是简单到批爆，让笔者一下子竟有些不太适应，情不自禁摆了起来。希望后两次作业可以给笔者带来一些不一样的惊喜，越难才越有写博客的动力，那么下周再见喽。

